<map proto="1.4.2">
<name>Smoke 5v5</name>
<version>1.3.2</version>
<objective>Capture 5 points (excluding top mid) sequentially!</objective>
<authors>
    <author uuid="2958ea4c-3501-404e-88cc-12e8632f68cc"/> <!-- NixaniaXi -->
</authors>
<contributors>
    <contributor uuid="dff980ed-9f69-491e-b79c-30c21350baf2" contribution="XML"/> <!-- DoomRobotBoy -->
    <contributor uuid="459fd919-0d58-401a-9601-6cab1eb721ab" contribution="Tourney edits"/> <!-- Reshif -->
</contributors>
<teams>
    <team id="red" color="dark red" max="5" max-overfill="5">Red</team>
    <team id="yellow" color="yellow" max="5" max-overfill="5">Yellow</team>
</teams>
<kits>
    <kit id="spawn-kit">
        <clear/>
        <item slot="0" unbreakable="true" material="stone sword"/>
        <item slot="1" unbreakable="true" material="bow"/>
        <item slot="2" material="golden apple"/>
        <item slot="8" amount="10" material="arrow"/>
        <helmet unbreakable="true" team-color="true" material="leather helmet"/>
        <chestplate unbreakable="true" team-color="true" material="leather chestplate"/>
        <leggings unbreakable="true" team-color="true" material="chainmail leggings">
            <enchantment level="3">projectile_protection</enchantment>
        </leggings>
        <boots unbreakable="true" material="iron boots">
            <enchantment>fire_protection</enchantment>
        </boots>
    </kit>
</kits>
<spawns>
    <default>
        <region yaw="45">
            <block>23,20,-23</block>
        </region>
    </default>
    <spawn team="red" kit="spawn-kit">
        <region yaw="180">
            <block>69,3,29</block>
        </region>
    </spawn>
    <spawn team="yellow" kit="spawn-kit">
        <region yaw="-90">
            <block>-29,3,-69</block>
        </region>
    </spawn>
</spawns>
<filters>
    <!-- Capture rules for visual control points, which must be captured sequentially -->
    <any id="filter-red-last">
        <team id="only-red">red</team>
        <objective id="capped-red-2nd">red-2nd</objective>
    </any>
    <any id="filter-red-2nd">
        <objective id="capped-red-last">red-last</objective>
        <filter id="capped-bot-mid"/>
    </any>
    <any id="filter-bot-mid">
        <filter id="capped-red-2nd"/>
        <filter id="capped-yellow-2nd"/>
    </any>
    <any id="filter-yellow-2nd">
        <objective id="capped-bot-mid">bot-mid</objective>
        <objective id="capped-yellow-last">yellow-last</objective>
    </any>
    <any id="filter-yellow-last">
        <filter id="only-yellow"/>
        <objective id="capped-yellow-2nd">yellow-2nd</objective>
    </any>
    <!-- Filters for the point-giving control points -->
    <!--
        A team can capture a point-giving control point when they capture the enemy's associated
        visual point. If the enemy uncaptures the point, they will return the point-giving
        point to a neutral state and points will no longer be scored from it by the team who lost
        control. Once one team reaches 750 points, or gains full control, the match will end.
    -->
    <any id="mercy-cap">
        <all>
            <filter id="only-red"/>
            <filter id="capped-yellow-last"/>
        </all>
        <all>
            <team id="only-yellow">yellow</team>
            <filter id="capped-red-last"/>
        </all>
    </any>
    <any id="filter-last-point-red">
        <filter id="capped-yellow-last"/>
        <all>
            <filter id="only-yellow"/>
            <not>
                <any>
                    <objective team="yellow">yellow-last</objective>
                    <objective team="red">yellow-last</objective>
                </any>
            </not>
        </all>
    </any>
    <any id="filter-2nd-point-red">
        <filter id="capped-yellow-2nd"/>
        <all>
            <filter id="only-yellow"/>
            <not>
                <any>
                    <objective team="red">yellow-2nd</objective>
                    <objective team="yellow">yellow-2nd</objective>
                </any>
            </not>
        </all>
    </any>
    <any id="filter-2nd-point-yellow">
        <filter id="capped-red-2nd"/>
        <all>
            <filter id="only-red"/>
            <not>
                <any>
                    <objective team="red">red-2nd</objective>
                    <objective team="yellow">red-2nd</objective>
                </any>
            </not>
        </all>
    </any>
    <any id="filter-last-point-yellow">
        <filter id="capped-red-last"/>
        <all>
            <filter id="only-red"/>
            <not>
                <any>
                    <objective team="yellow">red-last</objective>
                    <objective team="red">red-last</objective>
                </any>
            </not>
        </all>
    </any>
    <!-- Time-based spawn time filters -->
    <not id="spawn-1">
        <time>2m</time>
    </not>
    <all id="spawn-2">
        <time>2m</time>
        <not>
            <time>4m</time>
        </not>
    </all>
    <all id="spawn-3">
        <time>4m</time>
        <not>
            <time>6m</time>
        </not>
    </all>
    <all id="spawn-4">
        <time>6m</time>
        <not>
            <time>8m</time>
        </not>
    </all>
    <all id="spawn-5">
        <time>8m</time>
        <not>
            <time>10m</time>
        </not>
    </all>
    <all id="spawn-6">
        <time>10m</time>
    </all>
    <!-- Portal filters -->
    <all id="portal-red-mid-active">
        <objective id="capped-top-mid">top-mid</objective>
        <not>
            <filter id="capped-yellow-2nd"/>
        </not>
    </all>
    <all id="portal-red-red-2nd-active">
        <filter id="capped-red-2nd"/>
        <not>
            <filter id="capped-top-mid"/>
        </not>
    </all>
    <all id="portal-yellow-yellow-2nd-active">
        <filter id="capped-yellow-2nd"/>
        <not>
            <filter id="capped-top-mid"/>
        </not>
    </all>
    <all id="portal-yellow-mid-active">
        <filter id="capped-top-mid"/>
        <not>
            <filter id="capped-red-2nd"/>
        </not>
    </all>
</filters>
<regions>
    <union id="spawns">
        <rectangle id="red-spawn" min="65,11" max="72,32"/>
        <rectangle id="yellow-spawn" min="-10,-64" max="-31,-71"/>
    </union>
    <!-- Control points -->
    <cuboid id="cp-red-last" min="58,6,18" max="51,22,25"/>
    <cuboid id="cp-red-2nd" min="27,10,32" max="20,22,39"/>
    <cuboid id="cp-bot-mid" min="2,2,-1" max="-7,22,8"/>
    <cuboid id="cp-top-mid" min="-17,9,18" max="-24,22,25"/>
    <cuboid id="cp-yellow-2nd" min="-31,10,-19" max="-38,22,-26"/>
    <cuboid id="cp-yellow-last" min="-17,6,-57" max="-24,22,-50"/>
    <!-- Red portals -->
    <cuboid id="portal-red-red-2nd" min="65.5,3,20" max="67.5,6,23"/>
    <cuboid id="portal-red-mid" min="65.5,3,20" max="67.5,6,23"/>
    <cuboid id="portal-red-yellow-2nd" min="65.5,3,20" max="67.5,6,23"/>
    <!-- Yellow portals-->
    <cuboid id="portal-yellow-yellow-2nd" min="-22,3,-64.5" max="-19,6,-66.5"/>
    <cuboid id="portal-yellow-mid" min="-22,3,-64.5" max="-19,6,-66.5"/>
    <cuboid id="portal-yellow-red-2nd" min="-22,3,-64.5" max="-19,6,-66.5"/>
    <apply enter="never" region="spawns" message="You may not re-enter the spawns!"/>
    <apply block="never" use="never"/>
</regions>
<portals>
    <!-- Red portals -->
    <portal x="@34" y="@9" z="@36" yaw="@180" region="portal-red-red-2nd" filter="portal-red-red-2nd-active"/>
    <portal x="@5.5" y="@12" z="@33" yaw="@180" region="portal-red-mid" filter="portal-red-mid-active"/>
    <portal x="@-16" y="@7" z="@-13" yaw="@0" region="portal-red-yellow-2nd" filter="capped-yellow-2nd"/>
    <!-- Yellow portals -->
    <portal x="@-35" y="@9" z="@-33" yaw="@-90" region="portal-yellow-yellow-2nd" filter="portal-yellow-yellow-2nd-active"/>
    <portal x="@-32" y="@12" z="@-4.5" yaw="@-90" region="portal-yellow-mid" filter="portal-yellow-mid-active"/>
    <portal x="@14" y="@7" z="@17" yaw="@90" region="portal-yellow-red-2nd" filter="capped-red-2nd"/>
</portals>
<control-points neutral-state="true" show-progress="true">
    <!-- Red visual control points -->
    <control-point initial-owner="red" id="red-last" required="false" name="Red Last" capture-time="5s" time-multiplier="0.25" points="0" incremental="true" capture="cp-red-last" progress="cp-red-last" player-filter="filter-red-last"/>
    <control-point initial-owner="red" id="red-2nd" required="false" name="Red 2nd" capture-time="5s" time-multiplier="0.25" points="0" incremental="true" capture="cp-red-2nd" progress="cp-red-2nd" player-filter="filter-red-2nd"/>
    <!-- Bottom mid -->
    <control-point id="bot-mid" required="false" name="Bottom Mid" capture-time="5s" time-multiplier="0.25" points="2" incremental="true" capture="cp-bot-mid" progress="cp-bot-mid" player-filter="filter-bot-mid"/>
    <!-- Top mid -->
    <control-point id="top-mid" required="false" name="Top Mid" capture-time="5s" time-multiplier="0.25" points="0" incremental="true" capture="cp-top-mid" progress="cp-top-mid"/>
    <!-- Yellow visual control points -->
    <control-point initial-owner="yellow" id="yellow-2nd" required="false" name="Yellow 2nd" capture-time="5s" time-multiplier="0.25" points="0" incremental="true" capture="cp-yellow-2nd" progress="cp-yellow-2nd" player-filter="filter-yellow-2nd"/>
    <control-point initial-owner="yellow" id="yellow-last" required="false" name="Yellow Last" capture-time="5s" time-multiplier="0.25" points="0" incremental="true" capture="cp-yellow-last" progress="cp-yellow-last" player-filter="filter-yellow-last"/>
    <!-- Point-giving control points -->
    <control-point id="red-last-point" required="false" show="false" points="10000" name="RL Point" capture-time="0s" capture="everywhere" player-filter="filter-last-point-yellow" capture-filter="only-yellow"/>
    <control-point id="red-2nd-point" required="false" show="false" points="1" name="R2 Point" capture-time="0s" capture="everywhere" player-filter="filter-2nd-point-yellow" capture-filter="only-yellow"/>
    <control-point id="yellow-2nd-point" required="false" show="false" points="1" name="Y2 Point" capture-time="0s" capture="everywhere" player-filter="filter-2nd-point-red" capture-filter="only-red"/>
    <control-point id="yellow-last-point" required="false" show="false" points="10000" name="YL Point" capture-time="0s" capture="everywhere" player-filter="filter-last-point-red" capture-filter="only-red"/>
</control-points>
<score>
    <limit>750</limit>
</score>
<toolrepair>
    <tool>stone sword</tool>
    <tool>bow</tool>
</toolrepair>
<itemremove>
    <item>leather helmet</item>
    <item>leather chestplate</item>
    <item>chainmail leggings</item>
    <item>iron boots</item>
</itemremove>
<itemkeep>
    <item>golden apple</item>
    <item>arrow</item>
</itemkeep>
<kill-reward>
    <item material="golden apple"/>
    <item amount="5" material="arrow"/>
</kill-reward>
<hunger>
    <depletion>off</depletion>
</hunger>
<respawns>
    <respawn delay="5s" filter="spawn-1"/>
    <respawn delay="6s" filter="spawn-2"/>
    <respawn delay="7s" filter="spawn-3"/>
    <respawn delay="8s" filter="spawn-4"/>
    <respawn delay="9s" filter="spawn-5"/>
    <respawn delay="10s" filter="spawn-6"/>
</respawns>
</map>
